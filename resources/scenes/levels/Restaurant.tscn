[gd_scene load_steps=23 format=3 uid="uid://c8lyl5x75huf"]

[ext_resource type="Script" path="res://src/levels/restaurant.gd" id="1_e5gyl"]
[ext_resource type="Script" path="res://src/managers/dispencer.gd" id="2_u64rt"]
[ext_resource type="Script" path="res://src/managers/table_manager.gd" id="3_xpgpf"]
[ext_resource type="Script" path="res://src/camera_switcher.gd" id="4_4dsf8"]
[ext_resource type="PackedScene" uid="uid://tfo0klgn4pd5" path="res://resources/scenes/objects/table.tscn" id="4_imob6"]
[ext_resource type="PackedScene" uid="uid://cunlob2e6ypu8" path="res://assets/models/restaurant.glb" id="5_6vbps"]
[ext_resource type="Environment" uid="uid://1jq8e0qxe4xh" path="res://resources/new_environment.tres" id="7_epkef"]
[ext_resource type="Script" path="res://resources/scenes/levels/spawner.gd" id="10_54lq6"]
[ext_resource type="Script" path="res://src/levels/cellar_entrance.gd" id="12_daxh7"]
[ext_resource type="PackedScene" uid="uid://cfr4u784045c3" path="res://resources/scenes/player/Player.tscn" id="12_ip4nm"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_03c1g"]

[sub_resource type="BoxMesh" id="BoxMesh_h82sa"]
size = Vector3(0.3, 0.3, 0.3)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_e3833"]

[sub_resource type="CapsuleMesh" id="CapsuleMesh_4kpqr"]
material = SubResource("StandardMaterial3D_e3833")
radius = 0.05
height = 0.3

[sub_resource type="NavigationMesh" id="NavigationMesh_x0sau"]
vertices = PackedVector3Array(-2.08984, -1.34889, -7.23434, -1.98984, -1.34889, -10.9343, -4.18984, -1.34889, -10.9343, -4.18984, -1.34889, -7.23434, 0.810163, -1.34889, -6.63434, 0.910163, -1.34889, -6.23434, 1.01016, -1.34889, -6.23434, 1.11016, -1.34889, -6.63434, -1.48984, -1.34889, -7.23434, 0.510163, -1.34889, -6.83434, 1.41016, -1.34889, -6.83434, 6.01016, -1.34889, -6.73434, 6.01016, -1.34889, -10.9343, -1.18984, -1.34889, -6.83434, 1.01016, -1.34889, -5.93434, 0.810163, -1.34889, -5.73434, -1.78984, -1.34889, -3.03434, -1.18984, -1.34889, -2.83434, -0.189837, -1.34889, -2.93434, 0.610163, -1.34889, -3.03434, 0.510163, -1.34889, -5.53434, -1.78984, -1.34889, -5.43434, 1.31016, -1.34889, -5.63434, 0.910163, -1.34889, -2.83434, -0.889837, -1.34889, -1.43434, -0.589837, -1.34889, -1.43434, 1.31016, -1.34889, -1.43434, 5.01016, -1.34889, -1.33434, 5.01016, -1.34889, -5.53434, -2.88984, -1.34889, -1.63434, -2.68984, -1.34889, -1.53434, -2.48984, -1.34889, -2.83434, -3.18984, -1.34889, -2.93434, -4.18984, -1.34889, -5.53434, -4.18984, -1.34889, -3.13434, -3.48984, -1.34889, -3.13434, -2.38984, -1.34889, 0.665663, -1.78984, -1.34889, 0.465662, -1.78984, -1.34889, 0.0656624, -2.48984, -1.34889, -0.134337, -3.18984, -1.34889, -0.334337, -3.48984, -1.34889, -0.134337, -4.18984, -1.34889, -0.134337, -4.18984, -1.34889, 0.465662, -3.38984, -1.34889, 0.565662, -2.68984, -1.34889, 2.16566, -2.88984, -1.34889, 1.76566, -3.18984, -1.34889, 3.36566, -2.38984, -1.34889, 3.36566, -3.48984, -1.34889, 3.56566, -4.18984, -1.34889, 3.56566, -4.18984, -1.34889, 4.16566, -1.68984, -1.34889, 4.16566, -1.68984, -1.34889, 3.56566, -2.48984, -1.34889, 2.36566, -1.18984, -1.34889, -0.134337, -1.18984, -1.34889, 0.665663, 0.0101628, -1.34889, 0.0656624, -0.389837, -1.34889, -0.334337, 1.21016, -1.34889, 4.26566, -0.789837, -1.34889, 1.76566, -1.08984, -1.34889, 3.36566, -0.389837, -1.34889, 4.16566, -0.0898371, -1.34889, 4.36566, 1.01016, -1.34889, 4.56566, 0.0101628, -1.34889, 8.06566, 1.01016, -1.34889, 8.06566, -1.08984, -1.34889, 1.36566, 0.710163, -1.34889, 0.0656624, 1.01016, -1.34889, -0.134337, 5.01016, -1.34889, 4.16566)
polygons = [PackedInt32Array(3, 2, 0), PackedInt32Array(0, 2, 1), PackedInt32Array(5, 4, 6), PackedInt32Array(6, 4, 7), PackedInt32Array(8, 0, 1), PackedInt32Array(4, 9, 7), PackedInt32Array(7, 9, 10), PackedInt32Array(8, 1, 10), PackedInt32Array(10, 1, 11), PackedInt32Array(11, 1, 12), PackedInt32Array(9, 13, 8), PackedInt32Array(8, 10, 9), PackedInt32Array(6, 14, 5), PackedInt32Array(5, 14, 15), PackedInt32Array(17, 16, 18), PackedInt32Array(18, 16, 19), PackedInt32Array(19, 16, 21), PackedInt32Array(19, 21, 20), PackedInt32Array(15, 14, 22), PackedInt32Array(15, 22, 20), PackedInt32Array(20, 22, 19), PackedInt32Array(19, 22, 23), PackedInt32Array(24, 17, 25), PackedInt32Array(25, 17, 18), PackedInt32Array(23, 22, 26), PackedInt32Array(26, 22, 28), PackedInt32Array(26, 28, 27), PackedInt32Array(30, 29, 31), PackedInt32Array(31, 29, 32), PackedInt32Array(35, 34, 33), PackedInt32Array(32, 35, 31), PackedInt32Array(31, 35, 16), PackedInt32Array(16, 35, 21), PackedInt32Array(21, 35, 33), PackedInt32Array(37, 36, 38), PackedInt32Array(38, 36, 39), PackedInt32Array(29, 30, 40), PackedInt32Array(40, 30, 39), PackedInt32Array(42, 41, 43), PackedInt32Array(43, 41, 44), PackedInt32Array(48, 47, 45), PackedInt32Array(45, 47, 46), PackedInt32Array(41, 40, 44), PackedInt32Array(51, 50, 49), PackedInt32Array(47, 48, 49), PackedInt32Array(49, 48, 53), PackedInt32Array(49, 53, 52), PackedInt32Array(49, 52, 51), PackedInt32Array(45, 54, 48), PackedInt32Array(40, 39, 44), PackedInt32Array(44, 39, 36), PackedInt32Array(44, 36, 46), PackedInt32Array(46, 36, 45), PackedInt32Array(38, 55, 37), PackedInt32Array(37, 55, 56), PackedInt32Array(56, 55, 58), PackedInt32Array(56, 58, 57), PackedInt32Array(64, 63, 59), PackedInt32Array(59, 63, 62), PackedInt32Array(59, 62, 61), PackedInt32Array(59, 61, 60), PackedInt32Array(53, 61, 52), PackedInt32Array(52, 61, 62), PackedInt32Array(66, 65, 64), PackedInt32Array(64, 65, 63), PackedInt32Array(67, 56, 60), PackedInt32Array(60, 56, 57), PackedInt32Array(60, 57, 68), PackedInt32Array(25, 58, 24), PackedInt32Array(24, 58, 55), PackedInt32Array(68, 69, 60), PackedInt32Array(60, 69, 59), PackedInt32Array(59, 69, 70), PackedInt32Array(70, 69, 27), PackedInt32Array(69, 26, 27)]
cell_size = 0.1
cell_height = 0.01

[sub_resource type="BoxShape3D" id="BoxShape3D_8aqmv"]

[sub_resource type="BoxMesh" id="BoxMesh_x7pwa"]
size = Vector3(11, 0.2, 11)

[sub_resource type="BoxShape3D" id="BoxShape3D_tss03"]
size = Vector3(20.8738, 0.2, 20.5488)

[sub_resource type="BoxMesh" id="BoxMesh_dkhm5"]
size = Vector3(2, 0.2, 4)

[sub_resource type="BoxShape3D" id="BoxShape3D_njbgh"]
size = Vector3(2, 0.2, 4)

[sub_resource type="BoxMesh" id="BoxMesh_3i0bd"]
size = Vector3(11, 0.2, 6)

[sub_resource type="BoxShape3D" id="BoxShape3D_g0gry"]

[node name="Restaurant" type="Node3D"]
script = ExtResource("1_e5gyl")

[node name="Dispencer" type="Node3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4.28776, 0, -4.5654)
script = ExtResource("2_u64rt")

[node name="DispencerAura" type="StaticBody3D" parent="Dispencer"]

[node name="DispencerAuraCol" type="CollisionShape3D" parent="Dispencer/DispencerAura"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.305683)
shape = SubResource("CylinderShape3D_03c1g")

[node name="Counter" type="MeshInstance3D" parent="Dispencer/DispencerAura"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -7.39347, 0.155681, -0.721754)
mesh = SubResource("BoxMesh_h82sa")
skeleton = NodePath("../..")

[node name="Indicator" type="MeshInstance3D" parent="Dispencer"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.532384, 0.258182)
visible = false
mesh = SubResource("CapsuleMesh_4kpqr")

[node name="FLoorPlan" type="NavigationRegion3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.746361, 1.42089, 0.54475)
navigation_mesh = SubResource("NavigationMesh_x0sau")

[node name="restaurant2" parent="FLoorPlan" instance=ExtResource("5_6vbps")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -4.32073)

[node name="CameraSwitcher" type="Node3D" parent="FLoorPlan/restaurant2" node_paths=PackedStringArray("restaurant", "kitchen")]
script = ExtResource("4_4dsf8")
restaurant = NodePath("../../../CameraRestaurant")
kitchen = NodePath("../../../KitchenCam")

[node name="KItchen" type="Area3D" parent="FLoorPlan/restaurant2/CameraSwitcher"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.05551, 0, -2.53112)

[node name="CollisionShape3D" type="CollisionShape3D" parent="FLoorPlan/restaurant2/CameraSwitcher/KItchen"]
shape = SubResource("BoxShape3D_8aqmv")

[node name="Restaurant" type="Area3D" parent="FLoorPlan/restaurant2/CameraSwitcher"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.07695, -0.537901, -1.18236)

[node name="CollisionShape3D" type="CollisionShape3D" parent="FLoorPlan/restaurant2/CameraSwitcher/Restaurant"]
shape = SubResource("BoxShape3D_8aqmv")

[node name="floor" type="MeshInstance3D" parent="FLoorPlan"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.362808, -1.46889, -0.695055)
mesh = SubResource("BoxMesh_x7pwa")

[node name="FloorCOll" type="StaticBody3D" parent="FLoorPlan/floor"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.105369, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="FLoorPlan/floor/FloorCOll"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0391845, 0.121993, -2.77441)
shape = SubResource("BoxShape3D_tss03")

[node name="Entry" type="MeshInstance3D" parent="FLoorPlan/floor"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 7.411)
mesh = SubResource("BoxMesh_dkhm5")

[node name="StaticBody3D" type="StaticBody3D" parent="FLoorPlan/floor/Entry"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="FLoorPlan/floor/Entry/StaticBody3D"]
shape = SubResource("BoxShape3D_njbgh")

[node name="Kitchen" type="MeshInstance3D" parent="FLoorPlan/floor"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -8.45615)
mesh = SubResource("BoxMesh_3i0bd")

[node name="StaticBody3D" type="StaticBody3D" parent="FLoorPlan/floor/Kitchen"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="FLoorPlan/floor/Kitchen/StaticBody3D"]
shape = SubResource("BoxShape3D_njbgh")

[node name="TableManager" type="Node" parent="FLoorPlan" node_paths=PackedStringArray("templates")]
unique_name_in_owner = true
script = ExtResource("3_xpgpf")
templates = [NodePath("Table"), NodePath("Table2"), NodePath("Table3"), NodePath("Table4"), NodePath("Table5")]

[node name="Table" parent="FLoorPlan/TableManager" instance=ExtResource("4_imob6")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.58739, 0, 2.52484)

[node name="Table2" parent="FLoorPlan/TableManager" instance=ExtResource("4_imob6")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.55306, 0, -1.12075)

[node name="Table3" parent="FLoorPlan/TableManager" instance=ExtResource("4_imob6")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.4866, 0, 2.50003)

[node name="Table4" parent="FLoorPlan/TableManager" instance=ExtResource("4_imob6")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.55885, 0, -0.976752)

[node name="Table5" parent="FLoorPlan/TableManager" instance=ExtResource("4_imob6")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.394876, 0, -0.976752)

[node name="Spawner" type="Marker3D" parent="FLoorPlan" node_paths=PackedStringArray("npcContainer")]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.44388, -0.769778, 7.46097)
script = ExtResource("10_54lq6")
npcContainer = NodePath("../../Npcs")

[node name="CellarEntrance" type="Area3D" parent="FLoorPlan"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4.85915, 0, -10.5865)
script = ExtResource("12_daxh7")

[node name="CollisionShape3D" type="CollisionShape3D" parent="FLoorPlan/CellarEntrance"]
shape = SubResource("BoxShape3D_g0gry")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = ExtResource("7_epkef")

[node name="Npcs" type="Node3D" parent="."]

[node name="Player" parent="." instance=ExtResource("12_ip4nm")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.15352, 0.00353631, 0)
move_speed = 8.0
acceleration = 200.0
rotation_speed = 10.0

[node name="CameraRestaurant" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.689645, 0.724148, 0, -0.724148, 0.689645, 0, 5.84508, 6.88263)
environment = ExtResource("7_epkef")
current = true
fov = 62.4
size = 0.089
near = 0.032

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="CameraRestaurant"]
transform = Transform3D(1, 0, 0, 0, 0.685081, 0.728467, 0, -0.728467, 0.685081, 0, 6.04551, 3.34648)
light_bake_mode = 0
shadow_enabled = true
shadow_transmittance_bias = 0.126
shadow_blur = 3.067

[node name="KitchenCam" type="Camera3D" parent="."]
transform = Transform3D(-0.226596, -0.468537, 0.85389, -0.0410374, 0.880508, 0.472252, -0.973124, 0.071969, -0.218747, 7.07287, 6.67309, -10.3831)
environment = ExtResource("7_epkef")

[connection signal="body_entered" from="FLoorPlan/restaurant2/CameraSwitcher/KItchen" to="FLoorPlan/restaurant2/CameraSwitcher" method="_on_k_itchen_body_entered"]
[connection signal="body_entered" from="FLoorPlan/restaurant2/CameraSwitcher/Restaurant" to="FLoorPlan/restaurant2/CameraSwitcher" method="_on_restaurant_body_entered"]
